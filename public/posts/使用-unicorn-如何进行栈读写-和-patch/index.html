<!doctype html>
<html lang="zh-cn">
  <head>
    <title>ä½¿ç”¨ Unicorn å¦‚ä½•è¿›è¡Œæ ˆè¯»å†™ å’Œ Patch // CYRUS STUDIO</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.131.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <meta name="keywords" content="CYRUS STUDIO, å®‰å“é€†å‘, Android Reverse Engineering, ç§»åŠ¨å¼€å‘, å®‰å“å¼€å‘, Python">
    <meta name="robots" content="index, follow">
    <link rel="stylesheet" href="/blog/css/main.min.d970c1dc93ec518baa03345e73aafb7a5a0879e5830ca966a23c6d3552430ab1.css" />
    

    
  


    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ä½¿ç”¨ Unicorn å¦‚ä½•è¿›è¡Œæ ˆè¯»å†™ å’Œ Patch">
  <meta name="twitter:description" content="ç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œå¦‚æœ‰è½¬å‘ï¼Œè¯·æ³¨æ˜æ–‡ç« å‡ºå¤„ï¼šhttps://cyrus-studio.github.io/blog/
struct.pack æ–¹æ³•ä»‹ç» struct.pack æ˜¯ Python æ ‡å‡†åº“ struct æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå°† Python çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ intã€floatã€longï¼‰æ‰“åŒ…ä¸ºå­—èŠ‚æµï¼Œä»¥ä¾¿åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ã€ç½‘ç»œä¼ è¾“æˆ–å†…å­˜æ“ä½œï¼ˆå¦‚ Unicorn ä»¿çœŸå™¨çš„ mem_writeï¼‰ä¸­ä½¿ç”¨ã€‚
è¯­æ³•ï¼š
import structstruct.pack(format, value) formatï¼šæŒ‡å®šæ•°æ®çš„æ ¼å¼ï¼Œä¾‹å¦‚ï¼š
&lt;fï¼šè¡¨ç¤ºå°ç«¯ï¼ˆ&lt;ï¼‰çš„ 4 å­—èŠ‚æµ®ç‚¹æ•°ï¼ˆfloatï¼‰
&lt;dï¼šè¡¨ç¤ºå°ç«¯çš„ 8 å­—èŠ‚åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆdoubleï¼‰
valueï¼šè¦è½¬æ¢çš„ Python å€¼ã€‚
æ•°æ®ç±»å‹æ ¼å¼
æ•°æ®ç±»å‹ æœ‰ç¬¦å·æ ¼å¼ï¼ˆå°å†™ï¼‰ æ— ç¬¦å·æ ¼å¼ï¼ˆå¤§å†™ï¼‰ å¤§å°ï¼ˆå­—èŠ‚ï¼‰ byte b (char) B (uchar) 1 short h (short) H (ushort) 2 int i (int) I (uint) 4 long q (long long) Q (ulong long) 8 float f (float) æ—  4 double d (double) æ—  8 å…¶ä»–ç‰¹æ®Šç±»å‹">

    <meta property="og:url" content="https://cyrus-studio.github.io/blog/posts/%E4%BD%BF%E7%94%A8-unicorn-%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E6%A0%88%E8%AF%BB%E5%86%99-%E5%92%8C-patch/">
  <meta property="og:site_name" content="CYRUS STUDIO">
  <meta property="og:title" content="ä½¿ç”¨ Unicorn å¦‚ä½•è¿›è¡Œæ ˆè¯»å†™ å’Œ Patch">
  <meta property="og:description" content="ç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œå¦‚æœ‰è½¬å‘ï¼Œè¯·æ³¨æ˜æ–‡ç« å‡ºå¤„ï¼šhttps://cyrus-studio.github.io/blog/
struct.pack æ–¹æ³•ä»‹ç» struct.pack æ˜¯ Python æ ‡å‡†åº“ struct æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå°† Python çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ intã€floatã€longï¼‰æ‰“åŒ…ä¸ºå­—èŠ‚æµï¼Œä»¥ä¾¿åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ã€ç½‘ç»œä¼ è¾“æˆ–å†…å­˜æ“ä½œï¼ˆå¦‚ Unicorn ä»¿çœŸå™¨çš„ mem_writeï¼‰ä¸­ä½¿ç”¨ã€‚
è¯­æ³•ï¼š
import structstruct.pack(format, value) formatï¼šæŒ‡å®šæ•°æ®çš„æ ¼å¼ï¼Œä¾‹å¦‚ï¼š
&lt;fï¼šè¡¨ç¤ºå°ç«¯ï¼ˆ&lt;ï¼‰çš„ 4 å­—èŠ‚æµ®ç‚¹æ•°ï¼ˆfloatï¼‰
&lt;dï¼šè¡¨ç¤ºå°ç«¯çš„ 8 å­—èŠ‚åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆdoubleï¼‰
valueï¼šè¦è½¬æ¢çš„ Python å€¼ã€‚
æ•°æ®ç±»å‹æ ¼å¼
æ•°æ®ç±»å‹ æœ‰ç¬¦å·æ ¼å¼ï¼ˆå°å†™ï¼‰ æ— ç¬¦å·æ ¼å¼ï¼ˆå¤§å†™ï¼‰ å¤§å°ï¼ˆå­—èŠ‚ï¼‰ byte b (char) B (uchar) 1 short h (short) H (ushort) 2 int i (int) I (uint) 4 long q (long long) Q (ulong long) 8 float f (float) æ—  4 double d (double) æ—  8 å…¶ä»–ç‰¹æ®Šç±»å‹">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-23T17:56:08+08:00">
    <meta property="article:modified_time" content="2025-02-23T17:56:08+08:00">


  </head>
  <body>
    <header class="app-header">
      <a href="https://cyrus-studio.github.io/blog/"><img class="app-header-avatar" src="/blog/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">CYRUS STUDIO</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/blog/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/blog/about/">About</a>
             - 
          
          <a class="app-header-menu-item" href="https://github.com/CYRUS-STUDIO">GitHub</a>
      </nav>
      <p>å…¬ä¼—å·ï¼šCYRUS STUDIO</p>
      

      <div class="qrcode-container">
          <img src="/blog/gongzhonghao.jpg" alt="å…¬ä¼—å·äºŒç»´ç " class="qrcode-image">
          <p class="qrcode-text">æ‰«ç å…³æ³¨å…¬ä¼—å·</p>
      </div>

      <div class="visitor-counter">               
        
        <div id="pageview-wrapper" style="display: none; margin-top: 1rem; font-size: 0.9rem; color: #888;">
          ğŸ‘€ è®¿é—®æ¬¡æ•°ï¼š<span class="waline-pageview-count" data-path="/">0</span>
        </div>
      </div>

      <script type="module">
        import { pageviewCount } from 'https://unpkg.com/@waline/client@v3/dist/pageview.js';

        
        pageviewCount({
          serverURL: 'https://waline-15wtwfoa7-cyrus-studios-projects.vercel.app',
          path: '/',
          update: true
        });

        
        setTimeout(() => {
          const el = document.querySelector('.waline-pageview-count[data-path="/"]');
          const count = el?.innerText?.trim();
          if (count && count !== '0') {
            document.getElementById('pageview-wrapper').style.display = 'block';
          }
        }, 2000);
      </script>

    </header>
    <main class="app-container">
      
<article class="post">
  <header class="post-header">
    <meta charset="UTF-8"/>
    <h1 class="post-title">ä½¿ç”¨ Unicorn å¦‚ä½•è¿›è¡Œæ ˆè¯»å†™ å’Œ Patch</h1>
    <div class="post-meta" style="display: flex; gap: 1em; flex-wrap: wrap; align-items: center;">
      <div>
        <span class="meta-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-eye">
  <title>eye</title>
  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle>
</svg>
          é˜…è¯»é‡: <span class="waline-pageview-count" data-path="/blog/posts/%E4%BD%BF%E7%94%A8-unicorn-%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E6%A0%88%E8%AF%BB%E5%86%99-%E5%92%8C-patch/"></span>
        </span>
      </div>
      <div>
        <span class="meta-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Feb 23, 2025
        </span>
      </div>
      <div>
        <span class="meta-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          3 min read
        </span>
      </div>
    </div>

    <link
      rel="stylesheet"
      href="https://unpkg.com/@waline/client@v3/dist/waline.css"
    />

    <link rel="stylesheet" href="/blog/css/waline-custom.css">

  </header>
  <div class="post-content">
    <blockquote>
<p>ç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œå¦‚æœ‰è½¬å‘ï¼Œè¯·æ³¨æ˜æ–‡ç« å‡ºå¤„ï¼š<a href="https://cyrus-studio.github.io/blog/">https://cyrus-studio.github.io/blog/</a></p>
</blockquote>
<h1 id="structpack-æ–¹æ³•ä»‹ç»"><strong>struct.pack æ–¹æ³•ä»‹ç»</strong></h1>
<p>struct.pack æ˜¯ Python æ ‡å‡†åº“ struct æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå°† Python çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ intã€floatã€longï¼‰æ‰“åŒ…ä¸ºå­—èŠ‚æµï¼Œä»¥ä¾¿åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ã€ç½‘ç»œä¼ è¾“æˆ–å†…å­˜æ“ä½œï¼ˆå¦‚ Unicorn ä»¿çœŸå™¨çš„ mem_writeï¼‰ä¸­ä½¿ç”¨ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>import struct

struct.pack(format, value)
</code></pre><ul>
<li>
<p>formatï¼šæŒ‡å®šæ•°æ®çš„æ ¼å¼ï¼Œä¾‹å¦‚ï¼š</p>
</li>
<li>
<p>&lt;fï¼šè¡¨ç¤ºå°ç«¯ï¼ˆ&lt;ï¼‰çš„ 4 å­—èŠ‚æµ®ç‚¹æ•°ï¼ˆfloatï¼‰</p>
</li>
<li>
<p>&lt;dï¼šè¡¨ç¤ºå°ç«¯çš„ 8 å­—èŠ‚åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆdoubleï¼‰</p>
</li>
<li>
<p>valueï¼šè¦è½¬æ¢çš„ Python å€¼ã€‚</p>
</li>
</ul>
<p><strong>æ•°æ®ç±»å‹æ ¼å¼</strong></p>
<table>
<thead>
<tr>
<th>æ•°æ®ç±»å‹</th>
<th>æœ‰ç¬¦å·æ ¼å¼ï¼ˆå°å†™ï¼‰</th>
<th>æ— ç¬¦å·æ ¼å¼ï¼ˆå¤§å†™ï¼‰</th>
<th>å¤§å°ï¼ˆå­—èŠ‚ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>byte</td>
<td>b (char)</td>
<td>B (uchar)</td>
<td>1</td>
</tr>
<tr>
<td>short</td>
<td>h (short)</td>
<td>H (ushort)</td>
<td>2</td>
</tr>
<tr>
<td>int</td>
<td>i (int)</td>
<td>I (uint)</td>
<td>4</td>
</tr>
<tr>
<td>long</td>
<td>q (long long)</td>
<td>Q (ulong long)</td>
<td>8</td>
</tr>
<tr>
<td>float</td>
<td>f (float)</td>
<td>æ— </td>
<td>4</td>
</tr>
<tr>
<td>double</td>
<td>d (double)</td>
<td>æ— </td>
<td>8</td>
</tr>
</tbody>
</table>
<p><strong>å…¶ä»–ç‰¹æ®Šç±»å‹</strong></p>
<table>
<thead>
<tr>
<th>æ ¼å¼</th>
<th>è¯´æ˜</th>
<th>å­—èŠ‚æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>è·³è¿‡çš„å¡«å……å­—èŠ‚</td>
<td>1</td>
</tr>
<tr>
<td>s</td>
<td>char[]ï¼ˆå­—ç¬¦ä¸²ï¼‰</td>
<td>å¯å˜</td>
</tr>
<tr>
<td>p</td>
<td>Pascal é£æ ¼å­—ç¬¦ä¸²ï¼ˆé¦–å­—èŠ‚å­˜é•¿åº¦ï¼‰</td>
<td>å¯å˜</td>
</tr>
<tr>
<td>?</td>
<td>boolï¼ˆå¸ƒå°”å€¼ï¼‰</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>å­—èŠ‚é¡ºåºï¼ˆå¤§å°ç«¯ï¼‰</strong></p>
<table>
<thead>
<tr>
<th>å‰ç¼€</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>@</td>
<td>æŒ‰æœ¬æœºå­—èŠ‚é¡ºåºå­˜å‚¨</td>
</tr>
<tr>
<td>&lt;</td>
<td>å°ç«¯ï¼ˆLittle-Endianï¼‰</td>
</tr>
<tr>
<td>&gt;</td>
<td>å¤§ç«¯ï¼ˆBig-Endianï¼‰</td>
</tr>
<tr>
<td>=</td>
<td>æŒ‰æœ¬æœºå­—èŠ‚åºå­˜å‚¨ï¼ˆæ— å¯¹é½ï¼‰</td>
</tr>
<tr>
<td>!</td>
<td>ç½‘ç»œå­—èŠ‚åºï¼ˆå¤§ç«¯ï¼Œç­‰ä»·äº &gt; ï¼‰</td>
</tr>
</tbody>
</table>
<h1 id="unicorn-ä¸­æ ˆè¯»å†™ç¤ºä¾‹"><strong>Unicorn ä¸­æ ˆè¯»å†™ç¤ºä¾‹</strong></h1>
<p>ä½¿ç”¨ Unicorn æ¨¡æ‹Ÿå™¨è¿›è¡Œæ ˆæ“ä½œï¼Œå¹¶ä½¿ç”¨ struct å¤„ç†æ•°æ®æ‰“åŒ…/è§£åŒ…ã€‚</p>
<pre tabindex="0"><code>from unicorn import Uc, UC_ARCH_ARM64, UC_MODE_ARM
from unicorn.arm64_const import *
import struct

# å®šä¹‰å†…å­˜å¸ƒå±€
STACK_ADDR = 0x400000  # æ ˆåŸºå€
STACK_SIZE = 0x10000   # æ ˆå¤§å°

# åˆå§‹åŒ– Unicorn
mu = Uc(UC_ARCH_ARM64, UC_MODE_ARM)

# åˆ†é…æ ˆç©ºé—´
mu.mem_map(STACK_ADDR, STACK_SIZE)

# è®¾ç½® SPï¼ˆæ ˆæŒ‡é’ˆï¼‰
sp_init = STACK_ADDR + STACK_SIZE - 0x10  # é¢„ç•™ä¸€ç‚¹ç©ºé—´
mu.reg_write(UC_ARM64_REG_SP, sp_init)

# ç›´æ¥å†™å…¥å„ç§æ•°æ®ç±»å‹åˆ°æ ˆ
sp = mu.reg_read(UC_ARM64_REG_SP)

# å†™å…¥ byte
byte_value = 0x12
sp -= 1
mu.mem_write(sp, struct.pack(&#39;&lt;B&#39;, byte_value))
print(f&#34;Pushed byte {hex(byte_value)} to stack at {hex(sp)}&#34;)

# å†™å…¥ short
short_value = 0x1234
sp -= 2
mu.mem_write(sp, struct.pack(&#39;&lt;H&#39;, short_value))
print(f&#34;Pushed short {hex(short_value)} to stack at {hex(sp)}&#34;)

# å†™å…¥ int
int_value = 0x12345678
sp -= 4
mu.mem_write(sp, struct.pack(&#39;&lt;I&#39;, int_value))
print(f&#34;Pushed int {hex(int_value)} to stack at {hex(sp)}&#34;)

# å†™å…¥ long
long_value = 0x12345678ABCDEF01
sp -= 8
mu.mem_write(sp, struct.pack(&#39;&lt;Q&#39;, long_value))
print(f&#34;Pushed long {hex(long_value)} to stack at {hex(sp)}&#34;)

# å†™å…¥ float
float_value = 3.14
sp -= 4
mu.mem_write(sp, struct.pack(&#39;&lt;f&#39;, float_value))
print(f&#34;Pushed float {float_value} to stack at {hex(sp)}&#34;)

# å†™å…¥ double
double_value = 2.718281828459
sp -= 8
mu.mem_write(sp, struct.pack(&#39;&lt;d&#39;, double_value))
print(f&#34;Pushed double {double_value} to stack at {hex(sp)}&#34;)

mu.reg_write(UC_ARM64_REG_SP, sp)

# ç›´æ¥ä»æ ˆè¯»å–æ•°æ®
# è¯»å– double
double_read = struct.unpack(&#39;&lt;d&#39;, mu.mem_read(sp, 8))[0]
print(f&#34;Popped double {double_read} from stack at {hex(sp)}&#34;)
sp += 8

# è¯»å– float
float_read = struct.unpack(&#39;&lt;f&#39;, mu.mem_read(sp, 4))[0]
print(f&#34;Popped float {float_read} from stack at {hex(sp)}&#34;)
sp += 4

# è¯»å– long
long_read = struct.unpack(&#39;&lt;Q&#39;, mu.mem_read(sp, 8))[0]
print(f&#34;Popped long {hex(long_read)} from stack at {hex(sp)}&#34;)
sp += 8

# è¯»å– int
int_read = struct.unpack(&#39;&lt;I&#39;, mu.mem_read(sp, 4))[0]
print(f&#34;Popped int {hex(int_read)} from stack at {hex(sp)}&#34;)
sp += 4

# è¯»å– short
short_read = struct.unpack(&#39;&lt;H&#39;, mu.mem_read(sp, 2))[0]
print(f&#34;Popped short {hex(short_read)} from stack at {hex(sp)}&#34;)
sp += 2

# è¯»å– byte
byte_read = struct.unpack(&#39;&lt;B&#39;, mu.mem_read(sp, 1))[0]
print(f&#34;Popped byte {hex(byte_read)} from stack at {hex(sp)}&#34;)
sp += 1

mu.reg_write(UC_ARM64_REG_SP, sp)
print(&#34;Stack read/write successful for all data types!&#34;)
</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>Pushed byte 0x12 to stack at 0x40ffef
Pushed short 0x1234 to stack at 0x40ffed
Pushed int 0x12345678 to stack at 0x40ffe9
Pushed long 0x12345678abcdef01 to stack at 0x40ffe1
Pushed float 3.14 to stack at 0x40ffdd
Pushed double 2.718281828459 to stack at 0x40ffd5
Popped double 2.718281828459 from stack at 0x40ffd5
Popped float 3.140000104904175 from stack at 0x40ffdd
Popped long 0x12345678abcdef01 from stack at 0x40ffe1
Popped int 0x12345678 from stack at 0x40ffe9
Popped short 0x1234 from stack at 0x40ffed
Popped byte 0x12 from stack at 0x40ffef
Stack read/write successful for all data types!
</code></pre><h1 id="unicorn-ä¸­-patch-ç¤ºä¾‹"><strong>Unicorn ä¸­ Patch ç¤ºä¾‹</strong></h1>
<p>åœ¨ Unicorn ä¸­ï¼Œå¯ä»¥é€šè¿‡ mem_write æ–¹æ³•ç›´æ¥ä¿®æ”¹æŒ‡å®šåœ°å€çš„æŒ‡ä»¤æ•°æ®ã€‚ä¾‹å¦‚ï¼Œè¦å°†æŸä¸ªä½ç½®çš„æŒ‡ä»¤æ›¿æ¢ä¸º NOPã€‚</p>
<p>åœ¨ ARM64 æ¶æ„ä¸‹ï¼ŒNOP æŒ‡ä»¤çš„æœºå™¨ç æ˜¯ï¼š</p>
<pre tabindex="0"><code>NOP = 0xD503201F  # (ARM64 æŒ‡ä»¤ï¼Œå¤§ç«¯)
</code></pre><p>å®ƒå ç”¨ 4 å­—èŠ‚ã€‚</p>
<p>å‡è®¾ä½ è¦å°† 0x1000 å¤„çš„æŒ‡ä»¤æ›¿æ¢ä¸º NOPï¼š</p>
<pre tabindex="0"><code>import struct
from unicorn import Uc, UC_ARCH_ARM64, UC_MODE_ARM

# åˆå§‹åŒ– Unicorn
mu = Uc(UC_ARCH_ARM64, UC_MODE_ARM)

# åˆ†é…å†…å­˜ï¼ˆå‡è®¾ä»£ç æ®µåœ¨ 0x1000 å¤„ï¼‰
CODE_ADDR = 0x1000
CODE_SIZE = 0x1000
mu.mem_map(CODE_ADDR, CODE_SIZE)

# å†™å…¥ç¤ºä¾‹ä»£ç ï¼ˆå‡è®¾å·²æœ‰ä¸€äº›æŒ‡ä»¤ï¼‰
original_code = b&#34;\x00\x00\xA0\xE3&#34;  # ä¼ªé€ ä¸€æ¡æŒ‡ä»¤ï¼ˆMOV R0, #0ï¼‰
mu.mem_write(CODE_ADDR, original_code)

# æ›¿æ¢ä¸º NOP æŒ‡ä»¤
nop_opcode = struct.pack(&#34;&lt;I&#34;, 0xD503201F)  # ARM64 NOP æŒ‡ä»¤ï¼ˆå°ç«¯å­˜å‚¨ï¼‰
mu.mem_write(CODE_ADDR, nop_opcode)

# è¯»å–å¹¶éªŒè¯
patched_code = mu.mem_read(CODE_ADDR, 4)
print(f&#34;Patched instruction: {patched_code.hex()}&#34;)  # åº”è¾“å‡º &#34;1f2003d5&#34;
</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>Patched instruction: 1f2003d5
</code></pre><p>ä»è¾“å‡ºå¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸå°†æŒ‡å®šåœ°å€çš„æŒ‡ä»¤ Patch ä¸º NOP äº†ã€‚</p>

  </div>


  <div class="post-footer">

    
    

    
    <hr class="section-divider" />

    <div id="waline"></div>
    <script type="module">
      import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js';

      init({
        el: '#waline',
        serverURL: 'https://waline-15wtwfoa7-cyrus-studios-projects.vercel.app',
        path: location.pathname, 
        pageview: true,          
      });
    </script>
  </div>

</article>



<div id="toc" class="toc-container hidden"></div>


<button id="toc-toggle" class="toc-toggle" aria-label="ç›®å½•">
  &#9776;
</button>


<script src="/blog/js/toc.js"></script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
      
      document.querySelectorAll('pre').forEach(function(block) {
          
          var button = document.createElement('button');
          button.className = 'copy-btn';
          button.textContent = 'å¤åˆ¶';

          
          block.appendChild(button);

          
          var clipboard = new ClipboardJS(button, {
              target: function() {
                  return block.querySelector('code');
              }
          });

          
          clipboard.on('success', function(e) {
              e.trigger.textContent = 'å¤åˆ¶æˆåŠŸ';
              setTimeout(function() {
                  e.trigger.textContent = 'å¤åˆ¶';
              }, 2000);
          });

          
          clipboard.on('error', function(e) {
              e.trigger.textContent = 'å¤åˆ¶å¤±è´¥';
          });
      });
  });
</script>



    </main>
  </body>
</html>
