<!doctype html>
<html lang="zh-cn">
  <head>
    <title>åŸºäºPythonä¸K-Meansçš„è‡ªåŠ¨åŒ–è§†é¢‘åˆ†ç±»æ–¹æ³• // CYRUS STUDIO</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.131.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <meta name="keywords" content="CYRUS STUDIO, å®‰å“é€†å‘, Android Reverse Engineering, ç§»åŠ¨å¼€å‘, å®‰å“å¼€å‘, Python">
    <meta name="robots" content="index, follow">
    <link rel="stylesheet" href="/blog/css/main.min.d970c1dc93ec518baa03345e73aafb7a5a0879e5830ca966a23c6d3552430ab1.css" />
    

    
  


    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="åŸºäºPythonä¸K-Meansçš„è‡ªåŠ¨åŒ–è§†é¢‘åˆ†ç±»æ–¹æ³•">
  <meta name="twitter:description" content="ç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œå¦‚æœ‰è½¬å‘ï¼Œè¯·æ³¨æ˜æ–‡ç« å‡ºå¤„ï¼šhttps://cyrus-studio.github.io/blog/
å®ç°è¿‡ç¨‹ 1. ç‰¹å¾æå–ï¼šä½¿ç”¨é¢„è®­ç»ƒçš„ InceptionV3 æ¨¡å‹ï¼Œä»è§†é¢‘çš„è‹¥å¹²å¸§ä¸­æå–é«˜ç»´çš„è§†è§‰ç‰¹å¾ã€‚å°†æ¯ä¸ªè§†é¢‘çš„æ‰€æœ‰å¸§ç‰¹å¾å–å¹³å‡å€¼ï¼Œç”Ÿæˆä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡æ¥è¡¨ç¤ºè¯¥è§†é¢‘ã€‚
2. èšç±»ï¼šé€šè¿‡ K-Means çš„èšç±»ç»“æœï¼Œæ¯ä¸ªè§†é¢‘è¢«åˆ†é…äº†ä¸€ä¸ªç°‡æ ‡ç­¾ï¼Œä»£è¡¨è¯¥è§†é¢‘ä¸å“ªäº›è§†é¢‘åœ¨ç‰¹å¾ä¸Šæœ€ç›¸ä¼¼ã€‚
3. åˆ†ç±»æ•´ç†ï¼šæœ€åæ ¹æ®ç°‡æ ‡ç­¾ï¼Œå°†è§†é¢‘ç§»åŠ¨åˆ°ç›¸åº”çš„åˆ†ç±»æ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹å¯¹åº”ä¸€ä¸ªç°‡ã€‚
InceptionV3 æ¨¡å‹ InceptionV3 æ˜¯ä¸€ç§ç”¨äºå›¾åƒåˆ†ç±»å’Œç‰¹å¾æå–çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå®ƒæ˜¯Inception ç³»åˆ—æ¨¡å‹çš„ç¬¬ä¸‰ä¸ªç‰ˆæœ¬ï¼Œç”± Google åœ¨ 2015 å¹´æå‡ºã€‚
å®ƒæœ€åˆæ˜¯ä½œä¸ºå›¾åƒåˆ†ç±»ä»»åŠ¡çš„ä¸€ä¸ªæ¨¡å‹ï¼Œèƒ½å¤Ÿå°†å›¾åƒåˆ†ç±»åˆ° 1000 ä¸ªç±»åˆ«ä¸­ï¼ˆå¦‚ç‹—ã€çŒ«ã€æ±½è½¦ç­‰ï¼‰ã€‚é€šè¿‡å»é™¤æ¨¡å‹çš„æœ€åå‡ å±‚ï¼ˆåˆ†ç±»éƒ¨åˆ†ï¼‰ï¼Œå¯ä»¥å°† InceptionV3 ç”¨ä½œç‰¹å¾æå–å™¨ã€‚
ç°‡ ç°‡æ˜¯èšç±»ç®—æ³•çš„æ ¸å¿ƒæ¦‚å¿µï¼Œè¡¨ç¤ºæ•°æ®ä¸­ç›¸ä¼¼çš„å­é›†ï¼Œç›®çš„æ˜¯å°†æ— æ ‡ç­¾çš„æ•°æ®ç‚¹åˆ†ç»„ã€‚
K-Means K-Means æ˜¯ä¸€ç§å¸¸ç”¨çš„æ— ç›‘ç£èšç±»ç®—æ³•ï¼Œå®ƒçš„ç›®æ ‡æ˜¯å°†æ•°æ®ç‚¹åˆ†æˆ K ä¸ªç°‡ï¼ˆClusterï¼‰ï¼Œä½¿å¾—æ¯ä¸ªç°‡å†…çš„æ•°æ®ç‚¹å°½å¯èƒ½æ¥è¿‘åŒä¸€ä¸ªä¸­å¿ƒï¼ˆå³ç°‡çš„è´¨å¿ƒï¼‰ã€‚
ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡è¿­ä»£çš„æ–¹å¼æ‰¾åˆ° K ä¸ªæœ€ä¼˜çš„ç°‡è´¨å¿ƒï¼Œå¹¶æ ¹æ®è¿™äº›è´¨å¿ƒå°†æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚
æºç  1. å®‰è£…ä¾èµ–åº“ pip install moviepy scikit-learn tensorflow opencv-python 2. å®ç°ä»£ç  import osimport numpy as npimport cv2from moviepy.editor import VideoFileClipfrom sklearn.cluster import KMeansfrom tensorflow.keras.applications import InceptionV3from tensorflow.keras.applications.inception_v3 import preprocess_inputfrom tensorflow.">

    <meta property="og:url" content="https://cyrus-studio.github.io/blog/posts/%E5%9F%BA%E4%BA%8Epython%E4%B8%8Ek-means%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%86%E9%A2%91%E5%88%86%E7%B1%BB%E6%96%B9%E6%B3%95/">
  <meta property="og:site_name" content="CYRUS STUDIO">
  <meta property="og:title" content="åŸºäºPythonä¸K-Meansçš„è‡ªåŠ¨åŒ–è§†é¢‘åˆ†ç±»æ–¹æ³•">
  <meta property="og:description" content="ç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œå¦‚æœ‰è½¬å‘ï¼Œè¯·æ³¨æ˜æ–‡ç« å‡ºå¤„ï¼šhttps://cyrus-studio.github.io/blog/
å®ç°è¿‡ç¨‹ 1. ç‰¹å¾æå–ï¼šä½¿ç”¨é¢„è®­ç»ƒçš„ InceptionV3 æ¨¡å‹ï¼Œä»è§†é¢‘çš„è‹¥å¹²å¸§ä¸­æå–é«˜ç»´çš„è§†è§‰ç‰¹å¾ã€‚å°†æ¯ä¸ªè§†é¢‘çš„æ‰€æœ‰å¸§ç‰¹å¾å–å¹³å‡å€¼ï¼Œç”Ÿæˆä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡æ¥è¡¨ç¤ºè¯¥è§†é¢‘ã€‚
2. èšç±»ï¼šé€šè¿‡ K-Means çš„èšç±»ç»“æœï¼Œæ¯ä¸ªè§†é¢‘è¢«åˆ†é…äº†ä¸€ä¸ªç°‡æ ‡ç­¾ï¼Œä»£è¡¨è¯¥è§†é¢‘ä¸å“ªäº›è§†é¢‘åœ¨ç‰¹å¾ä¸Šæœ€ç›¸ä¼¼ã€‚
3. åˆ†ç±»æ•´ç†ï¼šæœ€åæ ¹æ®ç°‡æ ‡ç­¾ï¼Œå°†è§†é¢‘ç§»åŠ¨åˆ°ç›¸åº”çš„åˆ†ç±»æ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹å¯¹åº”ä¸€ä¸ªç°‡ã€‚
InceptionV3 æ¨¡å‹ InceptionV3 æ˜¯ä¸€ç§ç”¨äºå›¾åƒåˆ†ç±»å’Œç‰¹å¾æå–çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå®ƒæ˜¯Inception ç³»åˆ—æ¨¡å‹çš„ç¬¬ä¸‰ä¸ªç‰ˆæœ¬ï¼Œç”± Google åœ¨ 2015 å¹´æå‡ºã€‚
å®ƒæœ€åˆæ˜¯ä½œä¸ºå›¾åƒåˆ†ç±»ä»»åŠ¡çš„ä¸€ä¸ªæ¨¡å‹ï¼Œèƒ½å¤Ÿå°†å›¾åƒåˆ†ç±»åˆ° 1000 ä¸ªç±»åˆ«ä¸­ï¼ˆå¦‚ç‹—ã€çŒ«ã€æ±½è½¦ç­‰ï¼‰ã€‚é€šè¿‡å»é™¤æ¨¡å‹çš„æœ€åå‡ å±‚ï¼ˆåˆ†ç±»éƒ¨åˆ†ï¼‰ï¼Œå¯ä»¥å°† InceptionV3 ç”¨ä½œç‰¹å¾æå–å™¨ã€‚
ç°‡ ç°‡æ˜¯èšç±»ç®—æ³•çš„æ ¸å¿ƒæ¦‚å¿µï¼Œè¡¨ç¤ºæ•°æ®ä¸­ç›¸ä¼¼çš„å­é›†ï¼Œç›®çš„æ˜¯å°†æ— æ ‡ç­¾çš„æ•°æ®ç‚¹åˆ†ç»„ã€‚
K-Means K-Means æ˜¯ä¸€ç§å¸¸ç”¨çš„æ— ç›‘ç£èšç±»ç®—æ³•ï¼Œå®ƒçš„ç›®æ ‡æ˜¯å°†æ•°æ®ç‚¹åˆ†æˆ K ä¸ªç°‡ï¼ˆClusterï¼‰ï¼Œä½¿å¾—æ¯ä¸ªç°‡å†…çš„æ•°æ®ç‚¹å°½å¯èƒ½æ¥è¿‘åŒä¸€ä¸ªä¸­å¿ƒï¼ˆå³ç°‡çš„è´¨å¿ƒï¼‰ã€‚
ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡è¿­ä»£çš„æ–¹å¼æ‰¾åˆ° K ä¸ªæœ€ä¼˜çš„ç°‡è´¨å¿ƒï¼Œå¹¶æ ¹æ®è¿™äº›è´¨å¿ƒå°†æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚
æºç  1. å®‰è£…ä¾èµ–åº“ pip install moviepy scikit-learn tensorflow opencv-python 2. å®ç°ä»£ç  import osimport numpy as npimport cv2from moviepy.editor import VideoFileClipfrom sklearn.cluster import KMeansfrom tensorflow.keras.applications import InceptionV3from tensorflow.keras.applications.inception_v3 import preprocess_inputfrom tensorflow.">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-21T01:43:21+08:00">
    <meta property="article:modified_time" content="2024-09-21T01:43:21+08:00">


  </head>
  <body>
    <header class="app-header">
      <a href="https://cyrus-studio.github.io/blog/"><img class="app-header-avatar" src="/blog/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">CYRUS STUDIO</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/blog/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/blog/about/">About</a>
             - 
          
          <a class="app-header-menu-item" href="https://github.com/CYRUS-STUDIO">GitHub</a>
      </nav>
      <p>å…¬ä¼—å·ï¼šCYRUS STUDIO</p>
      

      <div class="qrcode-container">
          <img src="/blog/gongzhonghao.jpg" alt="å…¬ä¼—å·äºŒç»´ç " class="qrcode-image">
          <p class="qrcode-text">æ‰«ç å…³æ³¨å…¬ä¼—å·</p>
      </div>

      <div class="visitor-counter">               
   	    
        <div id="pageview-wrapper" style="display: none; margin-top: 1rem; font-size: 0.9rem; color: #888;">
          ğŸ‘€ è®¿é—®æ¬¡æ•°ï¼š<span class="waline-pageview-count" data-path="/">0</span>
        </div>
	    </div>

      <script type="module">
        import { pageviewCount } from 'https://unpkg.com/@waline/client@v3/dist/pageview.js';

        pageviewCount({
          serverURL: 'https://waline-15wtwfoa7-cyrus-studios-projects.vercel.app', 
          path: '/',
        }).then(() => {
          document.getElementById('pageview-wrapper').style.display = 'block';
        }).catch(err => {
          console.error('è®¿å®¢ç»Ÿè®¡åŠ è½½å¤±è´¥:', err);
        });
      </script>

    </header>
    <main class="app-container">
      
<article class="post">
  <header class="post-header">
    <meta charset="UTF-8"/>
    <h1 class="post-title">åŸºäºPythonä¸K-Meansçš„è‡ªåŠ¨åŒ–è§†é¢‘åˆ†ç±»æ–¹æ³•</h1>
    <div class="post-meta" style="display: flex; gap: 1em; flex-wrap: wrap; align-items: center;">
      <div>
        <span class="meta-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-eye">
  <title>eye</title>
  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle>
</svg>
          é˜…è¯»é‡: <span class="waline-pageview-count" data-path="/blog/posts/%E5%9F%BA%E4%BA%8Epython%E4%B8%8Ek-means%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%86%E9%A2%91%E5%88%86%E7%B1%BB%E6%96%B9%E6%B3%95/"></span>
        </span>
      </div>
      <div>
        <span class="meta-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Sep 21, 2024
        </span>
      </div>
      <div>
        <span class="meta-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </span>
      </div>
    </div>

    <link
      rel="stylesheet"
      href="https://unpkg.com/@waline/client@v3/dist/waline.css"
    />

  </header>
  <div class="post-content">
    <blockquote>
<p>ç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œå¦‚æœ‰è½¬å‘ï¼Œè¯·æ³¨æ˜æ–‡ç« å‡ºå¤„ï¼š<a href="https://cyrus-studio.github.io/blog/">https://cyrus-studio.github.io/blog/</a></p>
</blockquote>
<h1 id="__å®ç°è¿‡ç¨‹__"><strong>å®ç°è¿‡ç¨‹</strong></h1>
<p>1. ç‰¹å¾æå–ï¼šä½¿ç”¨é¢„è®­ç»ƒçš„ InceptionV3 æ¨¡å‹ï¼Œä»è§†é¢‘çš„è‹¥å¹²å¸§ä¸­æå–é«˜ç»´çš„è§†è§‰ç‰¹å¾ã€‚å°†æ¯ä¸ªè§†é¢‘çš„æ‰€æœ‰å¸§ç‰¹å¾å–å¹³å‡å€¼ï¼Œç”Ÿæˆä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡æ¥è¡¨ç¤ºè¯¥è§†é¢‘ã€‚</p>
<p>2. èšç±»ï¼šé€šè¿‡ K-Means çš„èšç±»ç»“æœï¼Œæ¯ä¸ªè§†é¢‘è¢«åˆ†é…äº†ä¸€ä¸ªç°‡æ ‡ç­¾ï¼Œä»£è¡¨è¯¥è§†é¢‘ä¸å“ªäº›è§†é¢‘åœ¨ç‰¹å¾ä¸Šæœ€ç›¸ä¼¼ã€‚</p>
<p>3. åˆ†ç±»æ•´ç†ï¼šæœ€åæ ¹æ®ç°‡æ ‡ç­¾ï¼Œå°†è§†é¢‘ç§»åŠ¨åˆ°ç›¸åº”çš„åˆ†ç±»æ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹å¯¹åº”ä¸€ä¸ªç°‡ã€‚</p>
<h2 id="__inceptionv3-æ¨¡å‹__"><strong>InceptionV3 æ¨¡å‹</strong></h2>
<p>InceptionV3 æ˜¯ä¸€ç§ç”¨äºå›¾åƒåˆ†ç±»å’Œç‰¹å¾æå–çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå®ƒæ˜¯Inception ç³»åˆ—æ¨¡å‹çš„ç¬¬ä¸‰ä¸ªç‰ˆæœ¬ï¼Œç”± Google åœ¨ 2015 å¹´æå‡ºã€‚</p>
<p>å®ƒæœ€åˆæ˜¯ä½œä¸ºå›¾åƒåˆ†ç±»ä»»åŠ¡çš„ä¸€ä¸ªæ¨¡å‹ï¼Œèƒ½å¤Ÿå°†å›¾åƒåˆ†ç±»åˆ° 1000 ä¸ªç±»åˆ«ä¸­ï¼ˆå¦‚ç‹—ã€çŒ«ã€æ±½è½¦ç­‰ï¼‰ã€‚é€šè¿‡å»é™¤æ¨¡å‹çš„æœ€åå‡ å±‚ï¼ˆåˆ†ç±»éƒ¨åˆ†ï¼‰ï¼Œå¯ä»¥å°† InceptionV3 ç”¨ä½œç‰¹å¾æå–å™¨ã€‚</p>
<h2 id="__ç°‡__"><strong>ç°‡</strong></h2>
<p>ç°‡æ˜¯èšç±»ç®—æ³•çš„æ ¸å¿ƒæ¦‚å¿µï¼Œè¡¨ç¤ºæ•°æ®ä¸­ç›¸ä¼¼çš„å­é›†ï¼Œç›®çš„æ˜¯å°†æ— æ ‡ç­¾çš„æ•°æ®ç‚¹åˆ†ç»„ã€‚</p>
<h2 id="__k-means__"><strong>K-Means</strong></h2>
<p>K-Means æ˜¯ä¸€ç§å¸¸ç”¨çš„æ— ç›‘ç£èšç±»ç®—æ³•ï¼Œå®ƒçš„ç›®æ ‡æ˜¯å°†æ•°æ®ç‚¹åˆ†æˆ K ä¸ªç°‡ï¼ˆClusterï¼‰ï¼Œä½¿å¾—æ¯ä¸ªç°‡å†…çš„æ•°æ®ç‚¹å°½å¯èƒ½æ¥è¿‘åŒä¸€ä¸ªä¸­å¿ƒï¼ˆå³ç°‡çš„è´¨å¿ƒï¼‰ã€‚</p>
<p>ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡è¿­ä»£çš„æ–¹å¼æ‰¾åˆ° K ä¸ªæœ€ä¼˜çš„ç°‡è´¨å¿ƒï¼Œå¹¶æ ¹æ®è¿™äº›è´¨å¿ƒå°†æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚</p>
<h1 id="__æºç __"><strong>æºç </strong></h1>
<h2 id="__1-å®‰è£…ä¾èµ–åº“__"><strong>1. å®‰è£…ä¾èµ–åº“</strong></h2>
<pre tabindex="0"><code>pip install moviepy scikit-learn tensorflow opencv-python
</code></pre><h2 id="__2-å®ç°ä»£ç __"><strong>2. å®ç°ä»£ç </strong></h2>
<pre tabindex="0"><code>import os
import numpy as np
import cv2
from moviepy.editor import VideoFileClip
from sklearn.cluster import KMeans
from tensorflow.keras.applications import InceptionV3
from tensorflow.keras.applications.inception_v3 import preprocess_input
from tensorflow.keras.preprocessing import image
from tensorflow.keras.models import Model
from shutil import move

# æå–è§†é¢‘çš„å¸§ä½œä¸ºç‰¹å¾
def extract_video_features(video_path, model, frame_interval=30):
    video = VideoFileClip(video_path)
    frame_count = 0
    features = []

    for frame in video.iter_frames(fps=1):  # ä»¥æ¯ç§’ä¸€å¸§çš„é€Ÿåº¦è·å–å¸§
        if frame_count % frame_interval == 0:
            # Resize frame to match model input size (299x299 for InceptionV3)
            img = cv2.resize(frame, (299, 299))
            img = image.img_to_array(img)
            img = np.expand_dims(img, axis=0)
            img = preprocess_input(img)

            # æå–ç‰¹å¾
            feature = model.predict(img)
            features.append(feature.flatten())

        frame_count += 1

    # å–è§†é¢‘çš„æ‰€æœ‰å¸§ç‰¹å¾çš„å‡å€¼ä½œä¸ºè§†é¢‘çš„æœ€ç»ˆç‰¹å¾
    return np.mean(features, axis=0)

# æ‰¹é‡æå–ç›®å½•ä¸‹æ‰€æœ‰è§†é¢‘çš„ç‰¹å¾
def extract_features_for_all_videos(input_dir, model, frame_interval=30):
    video_features = []
    video_files = []

    for filename in os.listdir(input_dir):
        if filename.endswith(&#34;.mp4&#34;):  # ä½ å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹æ–‡ä»¶æ ¼å¼
            video_path = os.path.join(input_dir, filename)
            print(f&#34;æ­£åœ¨å¤„ç†è§†é¢‘: {filename}&#34;)
            features = extract_video_features(video_path, model, frame_interval)
            video_features.append(features)
            video_files.append(filename)

    return np.array(video_features), video_files

# å¯¹è§†é¢‘è¿›è¡Œèšç±»
def cluster_videos(video_features, num_clusters=3):
    kmeans = KMeans(n_clusters=num_clusters, random_state=42)
    kmeans.fit(video_features)
    return kmeans.labels_

# å°†è§†é¢‘åˆ†ç±»åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹
def classify_videos(input_dir, output_dir, video_files, labels):
    for label, filename in zip(labels, video_files):
        output_folder = os.path.join(output_dir, f&#34;cluster_{label}&#34;)
        if not os.path.exists(output_folder):
            os.makedirs(output_folder)

        input_path = os.path.join(input_dir, filename)
        output_path = os.path.join(output_folder, filename)

        move(input_path, output_path)
        print(f&#34;å·²å°†è§†é¢‘ {filename} ç§»åŠ¨åˆ° {output_folder}&#34;)

# ä¸»å‡½æ•°
def main(input_dir, output_dir, num_clusters=3, frame_interval=30):
    # åŠ è½½é¢„è®­ç»ƒçš„InceptionV3æ¨¡å‹ï¼Œå¹¶å»æ‰é¡¶å±‚çš„åˆ†ç±»éƒ¨åˆ†ï¼Œåªç”¨æ¥æå–ç‰¹å¾
    base_model = InceptionV3(weights=&#39;imagenet&#39;)
    model = Model(inputs=base_model.input, outputs=base_model.get_layer(&#39;avg_pool&#39;).output)

    # æå–æ‰€æœ‰è§†é¢‘çš„ç‰¹å¾
    video_features, video_files = extract_features_for_all_videos(input_dir, model, frame_interval)

    # å¯¹è§†é¢‘è¿›è¡Œèšç±»
    labels = cluster_videos(video_features, num_clusters)

    # å°†è§†é¢‘ç§»åŠ¨åˆ°ç›¸åº”çš„åˆ†ç±»æ–‡ä»¶å¤¹
    classify_videos(input_dir, output_dir, video_files, labels)

# ç¤ºä¾‹è°ƒç”¨
input_directory = &#34;path/to/input_videos&#34;
output_directory = &#34;path/to/output_videos&#34;
main(input_directory, output_directory, num_clusters=30, frame_interval=30)
</code></pre><h2 id="__3-ä»£ç è¯´æ˜__"><strong>3. ä»£ç è¯´æ˜</strong></h2>
<p>1. extract_video_featuresï¼šä»æ¯ä¸ªè§†é¢‘ä¸­æå–å¸§ï¼Œä½¿ç”¨ InceptionV3 æ¨¡å‹æå–æ¯ä¸ªå¸§çš„ç‰¹å¾ï¼Œå¹¶æœ€ç»ˆå–æ‰€æœ‰å¸§ç‰¹å¾çš„å¹³å‡å€¼ä½œä¸ºè¯¥è§†é¢‘çš„ä»£è¡¨ç‰¹å¾ã€‚</p>
<p>2. extract_features_for_all_videosï¼šæ‰¹é‡æå–ç›®å½•ä¸­æ‰€æœ‰è§†é¢‘çš„ç‰¹å¾ã€‚</p>
<p>3. cluster_videosï¼šä½¿ç”¨ K-Means èšç±»ç®—æ³•å¯¹è§†é¢‘è¿›è¡Œåˆ†ç±»ï¼Œå°†ç›¸ä¼¼çš„è§†é¢‘èšåˆ°ä¸€èµ·ã€‚</p>
<p>4. classify_videosï¼šå°†è§†é¢‘æ ¹æ®èšç±»ç»“æœç§»åŠ¨åˆ°ä¸åŒçš„åˆ†ç±»æ–‡ä»¶å¤¹ã€‚</p>
<p>5. mainï¼šä¸»å‡½æ•°ï¼Œè´Ÿè´£åŠ è½½æ¨¡å‹ã€æå–ç‰¹å¾ã€èšç±»ä»¥åŠå°†è§†é¢‘åˆ†ç±»ã€‚</p>
<h2 id="__4-è°ƒç”¨è¯´æ˜__"><strong>4. è°ƒç”¨è¯´æ˜</strong></h2>
<p>1. input_directory: è§†é¢‘æ‰€åœ¨çš„è¾“å…¥æ–‡ä»¶å¤¹ã€‚</p>
<p>2. output_directory: è¾“å‡ºæ–‡ä»¶å¤¹ï¼Œç¨‹åºä¼šæ ¹æ®èšç±»ç»“æœåˆ›å»ºä¸åŒçš„æ–‡ä»¶å¤¹ï¼Œå°†ç›¸ä¼¼çš„è§†é¢‘åˆ†ç±»è¿›å»ã€‚</p>
<p>3. num_clusters: è¦åˆ†ç±»çš„ç±»åˆ«æ•°ï¼Œå³å¸Œæœ›å°†è§†é¢‘åˆ†ä¸ºå¤šå°‘ç±»ã€‚</p>
<p>4. frame_interval: æ¯éš”å¤šå°‘å¸§æå–ä¸€æ¬¡ç‰¹å¾å¸§ã€‚å€¼è¶Šå¤§ï¼Œæå–å¸§çš„é—´éš”è¶Šå¤§ã€‚</p>
<p>æºç åœ°å€ï¼š<a href="https://github.com/CYRUS-STUDIO/classify-videos-kmeans-python">https://github.com/CYRUS-STUDIO/classify-videos-kmeans-python</a></p>

  </div>


  <div class="post-footer">

    
    

    
    <hr class="section-divider" />

    <div id="waline"></div>
    <script type="module">
      import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js';

      init({
        el: '#waline',
        serverURL: 'https://waline-15wtwfoa7-cyrus-studios-projects.vercel.app',
        path: location.pathname, 
        pageview: true,          
      });
    </script>
  </div>

</article>



<div id="toc" class="toc-container hidden"></div>


<button id="toc-toggle" class="toc-toggle" aria-label="ç›®å½•">
  &#9776;
</button>


<script src="/blog/js/toc.js"></script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
      
      document.querySelectorAll('pre').forEach(function(block) {
          
          var button = document.createElement('button');
          button.className = 'copy-btn';
          button.textContent = 'å¤åˆ¶';

          
          block.appendChild(button);

          
          var clipboard = new ClipboardJS(button, {
              target: function() {
                  return block.querySelector('code');
              }
          });

          
          clipboard.on('success', function(e) {
              e.trigger.textContent = 'å¤åˆ¶æˆåŠŸ';
              setTimeout(function() {
                  e.trigger.textContent = 'å¤åˆ¶';
              }, 2000);
          });

          
          clipboard.on('error', function(e) {
              e.trigger.textContent = 'å¤åˆ¶å¤±è´¥';
          });
      });
  });
</script>



    </main>
  </body>
</html>
